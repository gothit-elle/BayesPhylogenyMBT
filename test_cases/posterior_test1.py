
import os
import sys
import inspect

currentdir = os.path.dirname(os.path.abspath(inspect.getfile(inspect.currentframe())))
parentdir = os.path.dirname(currentdir)
sys.path.insert(0, parentdir) 

import numpy as np
from treestruct import *
from nodestruct import *
from posterior import *
from buildmtrx import *
from MCMCMoves import *
from multiprocessing import freeze_support

"""# Posterior calc"""
if __name__ == '__main__':
	freeze_support()
	# relative rates matrix
	R = np.array([0, 0.5, 2, 0.5,
				  0.5, 0, 0.5, 2,
				  2, 0.5, 0, 0.5,
				  0.5, 2, 0.5, 0]).reshape(4,4)
	# initial distribution
	Pi = [0.295, 0.205, 0.205, 0.295]
	# rate matrix
	Q1 = R@np.diag(Pi)
	# need to adjust so rows sum to 0
	Q1 -= np.diag(Q1@np.ones(4))

	alpha = np.array([0.5,0.5]).astype(object)
	d, D0, D1, B = build_mtrx(mu0= 0.1, mu1= 0.1, q01 = 0.9, q10 =0.001, lambda0 = 1, lambda1 = 0.099)


	nodeStr = "2A.1T.17C.8G.9G.9T.18A." # nodes and branch lengths
	t=20 # obs time
	trees= []
	trees.append(Tree(1))
	trees[0].str2tree(nodeStr,t,by='df')
	trees[0].disp()

	mystr = "(4 / 'T'(2 / 'G'(5 / 'A')(5 / 'T'))(7 / 'C'))"
	t2 = Tree(1)
	t2.str2tree(mystr,4+7, by='io')
	trees.append(t2)
	t2.disp()

	nodeStr = "2T.3G.5A.5T.7C.1A.1T" # nodes and branch lengths
	t2 = Tree(1)
	t2.str2tree(nodeStr,10,by='df')
	trees.append(t2)
	t2.disp()

	nodeStr = "2T.5G.5A" # nodes and branch lengths
	t2 = Tree(1)
	t2.str2tree(nodeStr,7,by='df')
	trees.append(t2)
	t2.disp()

	s = "(34.33510731122711 / 'TAGCGGGTCATTTACAGACAATCCGGGGAACTGTAGCAATCCGCAGGGTAGGAGAAATATAAGATCATCTATTCTATCTACCCATACTTACTTAGCTACA'(13.639090371731882 / 'TAGCGGGTCATTTACAGACAATCCGGGGAACTGTAGCAATCCGCAGGGTAGGAAAAAAATAAGATCATCTATTCTATCTACCTATATTTACTTAGCTACA' + 'SpeciesForty-Eight')(4.034613962022226 / 'TCCTCAATATCCAGAATAGAATACTTTCATCAACTGCTGAAGTCTATGCACGAATTTTTCCGTATACTGCCCTTATCCCATCTAGGGAACTGGAGGATCA'(0.013177629543897049 / 'TCCTCAATATCCAGAATAGAATACTTTCATTAACTGCTGAAGTCTATGTACGAATTTTTCCGTATACTGCCCTTATCCCATCTAGGGAACCGGAGGATCA'(2.9990283157322173 / 'CCTACAAAAAGACCGTCGATCCACTTTTATCAACCAATCGTCTTCTGCCCCAGGTGTCATCCTGCACTTGATCCGTTTAGTATCTTAAACCAATGTACTT'(4.268261986347834 / 'TCAGGGTAGTAAATGAACTAAAAGCTTTACCTTAAATAAGTTCGCGTATGGTTCGTGCGCTCAATCTTCTTCGCGAAACATAATCAAATGACCGATTAAT'(0.06339061393828178 / 'TCTGGGTAGTAAATGAACTAAATACTTTACCTTAAATAAATTCGCGTATGGTTCGTGCGTTCCATCTTCTTCGCGAAACATAATCAAATGACCGATTAAT'(2.2606178641474264 / 'TTTGGAATCAAAAAGACATAAGTATCCTGCAGATTGTATGCCGTCACAGAAAGCATGCTCTCTTACAGTAGAGGTGGAAATAGGTCTGCTACTGAATGGC' + 'SpeciesForty-Seven')(2.2606178641474264 / 'TCTCGGTGTAAACAAATTTCTTTGGTGTATCTTTGGTTCAAATACTTGATGTCCTAGAACCCAATCCCGTCTTTGCGGTGTCGCTATCTCCCTGATATAT' + 'SpeciesForty-Six'))(2.324008478085708 / 'TCCTAATCGATTATGGTTGGGAGGCATCAGAATCTATACGGTTGAATATAGCCTCACTGATCTATGGGGCACTTAACAAGCGCCCAAAAATGTAATCGTC' + 'SpeciesForty-Five'))(3.5211018873276547 / 'TGCATCAGCGACACGTTGGTCTCAGTAAACGGCTCATGAAGCATTGGTAGTAGGGGACATTTAATATATAAGTGACATATTGCATATGAGCACAAAGCTC'(0.5330987261797803 / 'TGTACCATCGACACACTGTTTTCAGAAGACGAGTCATCGAGCCTTTATGCTCGATAGCATTTAATTGTTCAGTAACATATCTCATAATTGTGCATAACTC'(2.5380698509261075 / 'TTCGGTCCTAACTTTATATTTTTCAGTATTGCTCCCCACTGTCGTAACTTACATTCAATTCCACTGGACTGGATATCTCAGCAGGGAATTAGCTTTCATT' + 'SpeciesForty-Four')(2.5380698509261075 / 'TAATCTGTCCGTTGACATAGTTCGCAGTTGTTACTCTCGAGATTTTTTCACTGCAAAACTTTTGGCCACGATAAAAGAACAAAGTATAAAACCTTAACTA' + 'SpeciesForty-Three'))(3.0711685771058876 / 'TATTGATATATAAGTTTAGTGTCGCTTTTAATCCTACCTCGGATTAGTCTACCCGGCAAACTGAAGCGTGGGTATCTATTGATCGTAGCGAGTTGGTCGC' + 'SpeciesForty-Two')))(9.59129878016576 / 'CTAGTGTTAGTGGATAAAACAAGAGATAGCCTACAACGGAGTTTGGCTGATAAACTAGTAAACGTCATGATTTGTTGCAATTCTATATAAGAATGAACAT' + 'SpeciesForty-One'))(2.989966919285848 / 'TTAAATATCTTTTGATTAAAACAAGCTTGTAGCGCTGTTTCGACCATAGAAGATAATTAACATTTATCTATTCGATTCTATACTCCCTTCGCCTTTAGCA'(0.9374091358501809 / 'TAGAATTTCGCTTAGTTGCTATACGGCAGTTACACTGTTTGAATCATCGTAGGCGTACAGCACACCCCTTTTCAATCCTAAGGTTCGTTCGACTACAGTA'(0.0617516250596069 / 'TAGAATTTCGCTTAGTTGCTATACGGTAGTCACACTGTTTGAATCATCGTAGGCGTACAGCATATCCCTTTTCAATCCTAGGGTTCGTTCGATTACAGTA'(0.23959885774012638 / 'TAAAATACCGCCATGTTGCTATACGGTAGTCACACTGTTTGAATCATTGTGGGTGTACAGTATCTTCCTTTTCAATCCTAGCGCTCATTCGATGACTGTA'(0.6493327134076481 / 'CAAAATACAACCCAGCTGCAATGCGCAAGCCCCACTGATTGGACCATCACGGGTGAACAGTATCTTCCCCTTTAGTCTCAGCGTCTATCCTATGATTGTA'(0.4803272271409452 / 'GAACACACGACCCATCCGCAAAGCGCAAGCTCCACAAATTGGACCACCATAAGAGAGGCGTTCGTTTCCTTATAGTCTCATCGTCTATCCTGTATTGGCG'(0.5723201068902602 / 'GAACACAAAACCCACGGGTAAGAAGCTAGCTCCACCAATTAGGCCACCACAAAAGAAGTGACCGCTTCCTTCTAGCTCCAGCGTCGATCCTGTATTAACG'(3.6737698243350416 / 'GAACACAAAACCCACGGGTAAGAAGCTAGCTCCACCAATTAGGCCACCACAAAAGAAGTGACCGCTTCCTTCTAGCTCCAGCGTCGATCCTGTATTAACG' + 'SpeciesForty')(0.011727815383443186 / 'GAACACAAAACCCACGGGTAAGAAGCTAGCTCCACCAATTAGGCCACCACAAAAGAAGTGACCGCTTCCTTCTAGCTCCAGCGTCGATCCTGTATTAACG'(0.37507578455494844 / 'AAGCACAAAACCCACGTGTAAGAAGCTAGTTCCACCAATTGAGTCATCACAAAGTAAGTAACCGCTTCCTTCTAGCTCTAATGTCGTTTCTGTATCAACA'(3.28696622439665 / 'ATTTACAATTTCTATGTGTCGAGAGCCCGCTCTAGCGGATAAGCAATGAAAAGGAAAGCAATAATAATCTTCTGCCCCTGAAGTTCGTCCTGTATAGAGC' + 'SpeciesThirty-Nine')(0.12439399327388562 / 'AAGCATAAAACTCACTTGTAAGAAGCTAGTTCCACCAATTGAGTTATCACACAGTAAGCAACTGCTTCCTTCTAGCTCTAATGTCCTTTCTATATCAACA'(3.1625722311227644 / 'AAGCATAAAACTCACTTATAATAAGCTAGTTAAGTCAATTGAGTTATCACACAGCAAGCAACTGCCTCCTTCTAGCTTTAATGTCCTCTCTATATCAGCA' + 'SpeciesThirty-Eight')(0.8261412452704756 / 'GGGTATATGACATATTGATGGAACGTAAGTTCCAGTCCTTGTGTTATAATACAAAAGGTTTGTGCTCCCATTTAACACTAACGCTTTTTCCCTAATGATA'(2.3364309858522887 / 'GGGTGTCTGGCATGTTGAAGGAACATAGATTTCAGCCACTATATTAAGAAGCAAAGGGTTTGTACTCGCATTTAATACTAATACTTTTTCCCTAAGGAAA' + 'SpeciesThirty-Seven')(2.3364309858522887 / 'GGGTATATGACATATTGATAGTACGTAAGTTCCAGTCCTTGTGTTATAATACAAAAGGTTTGTGCTCCCATTTAACTCTAACGCTTCTTCCCTAATGATA' + 'SpeciesThirty-Six'))))(1.199788414460015 / 'AATGATAAAGTGAACGCGAAGGACGCCCATTTATCCCACTTTGTTACCAGAAACTCGGGAACCGATTACTCCTGGGTCTTATAACAACTCTGTACTTCCA'(0.6176671513554097 / 'AATGATAAGGTGGACTTGAAAGACGTATGAGTGCCTCGTCTTGTTGGTAGAGACTCCGGAAGCGGTCATTTTCGGGTCTAATTGCCGCGTTGAACTCGCA'(1.8445864431361738 / 'CATGACAAGGTGTACCTGTAGGACATGTATATACCTCGTCTCGCCGCTCGGGAATCCTGAAGGTGTTATCCTGGGCGCTAACCTACGTGTTGGGCTCCGA' + 'SpeciesThirty-Five')(1.8445864431361738 / 'AATAACAAGATGGACTTTAAAGACGTATGAGTGCCTCGTCTCGTTGGTAGAGACTCCGGAAGCGGTCACTTTCGGGCCTAATTGCCGCGTTGAACTCGCA' + 'SpeciesThirty-Four'))(0.06772920728862745 / 'AATGATAAAGTGAACGCGAAGGACGCCCATTTATTCCACTTTGTTACCAGATACTTGGGAACCGATTACTCCTGGGTCTTATAATAAATGTGTATTTCCA'(2.394524387202956 / 'AATGATAAAGTGAACGCGAAGGACGCCCATTTATTCCACTTTGTTGCCAGATACTTGGGAACCGATTACTCCTGGGTCTTATAATAAATGTGTATTTCCA' + 'SpeciesThirty-Three')(2.394524387202956 / 'AATGGCTCATTCTATAGTCTCAAGACTCTGTTTTATTTCTCTCTTATAATCTGCATGAGCGCCAGATGCTCTTACGTTCCGGGTTAAAAGCAGATCGCTG' + 'SpeciesThirty-Two')))))(0.4648513874229937 / 'GTAAACTCGGCCCTTTCGGAAATTGCAAGCCTAAGAAGTTGGACCGGCATAAGAGAGTCGTTCTGTTCCTTATGATCCCAAAGTCTATCATATAGTGGTG'(3.781238543802308 / 'GTAAATTGAACTCTTTTAGAGGTCGCGAGGTGAAAAAACCGTTTTACCCTAAGAGAGGAGTTCCATGCTAAGCCATCTTAATATCAGGCATAAATTGGCA' + 'SpeciesThirty-One')(0.4124028156740198 / 'GTGAACTCGTTCGCTTCGGAATCCCGAATCCTAAGAAATTGGAACAGCATAAGAGAATCGTCTCGTCTAGTACGACCTCGGAGTTTAACATATAGTGGTG'(0.4601775201797365 / 'GTCAGCGGGTTCGCCGTAGAATTCCGAATCTGAAGAATTTGAAACAGCATCAGAGAATTGTCTCATCTACTATGATCTCGGAATTAAACATACAGTGATG'(2.9086582079485517 / 'GCCAGCGGGTTTACCGTAGAATTCCGAATCTAAAGAATTAGGCACAGCATTAAAGAATTGTTTCATCTACTTTGGTCTTGGAATTAATCATACAGTGGCG' + 'SpeciesThirty')(0.07942187570787991 / 'GTCAGCGAATTCGCCGTAGAATTCCGTATCTGAAGAATTTGAAACAGCATAAGAGAATTGTCTCATCTACTATGATCCCGGAATTAAACATACAATGATG'(2.8292363322406717 / 'GTCAGCGAATTCGCCGTAGAATTTCGTATCTGAAGAATTTGAAACAGCATAAGAGAATTGTCTCAATTACTATGATCCCGGAATTAAACATACAATGATG' + 'SpeciesTwenty-Nine')(0.17984544936464503 / 'GTCAGCGAATTTGCCGTAGAATTCCTTATGAGAAGAATTTGAAACAGCCTAAGAGAATTATCTCATCTACTATGATCCCGGTACAAAACACACAATGATG'(0.12274207036250018 / 'GTAAACGAATTTGCCGTAGAACTCCTTATGAGAAAAATTCGAAACAGCTTAAGAGAATTATCTCATCTTCTATGATCCCGGTACAAAACACATAATGATA'(0.24480970171977853 / 'GTAAACGAATTTGCCGGAGAATTCTTTATGGAAAAATCTCGAAACAGCTTAATAGAATTATCTCATCTTCCATGCTTCCGGTACATCACTCATAATGATA'(2.281839110793748 / 'ATAAACAAACTTGCCGGAGAATTCTTTGCGGAAGAGTCTCGAGACAGCCTAGTAGTGCTATCTCATCTTCCATGCTTCCGGTACATCATTCATAATGATA' + 'SpeciesTwenty-Eight')(2.281839110793748 / 'GTAAACGAATTTGCCGGAGAATTCTTTATGGAAAAATCTCGAAACAGCTTAATAGAATTATCTCATCTTCCATGCTTCCGGTACATCACTCATAATGATA' + 'SpeciesTwenty-Seven'))(0.2861160631053068 / 'ATAGACGAATTTGCTTTAGCACTCTCCATGGGCAGAATTGGACACAGCTGAAGAAAATTATCTTATCTTATATGATCCTGCCACGAGGCACGTAATGATG'(0.15389528035148925 / 'ATAGATGAATTTACTTTAGCACTCTCGATGGGCAGAATTGGACACAGCTGAGGGAAATTACCTCCCCTTATTTGATCCTGCCACTAGGCACGTATTGATG'(2.086637469056731 / 'GCAAATGAACTTACTTTAGCACTCTTGATGGACAGTTTTAGTCATGTCTCAGAGAAATTATATCTTTTTATTGGGCCCTGCCACTAGGCACATACTGCTG' + 'SpeciesTwenty-Six')(0.4087757369288699 / 'ATAGACGACTCTATTTTGGCACTCTTGATCGGCAGAAGAGGCAAGAACTGAGGGCAATTACTTCCCCCTATTTGATCATGCCGCTAGGGAAATATTGGTG'(0.47407324185549937 / 'ATAGACGACCCGAGCTTGGCACTCCTGTCCGGCGAAAACGCTAAGACTTAAGAGCAATGACTTCCCCCTACTATATTACACCGCTAGGGAAATAGTGGTG'(0.6284114839379688 / 'GTAGACTACCTCAGCTCGATATTCCCGTTTTGTAAATACGCTGGGAATGGATAGCAATAAAATCTACGCACTATATCATACCGCTTAGGAATTAAGGATA'(0.5753770063343929 / 'GTAGAGTGCCTCAGTCCAGTATTCCGGTTTCGTAAACTGGCTGGAGGTGGATAGCAATGGAATCCATGCACCATATCAAGCCACTTAGGAATCGAGAATA' + 'SpeciesTwenty-Five')(0.34543705094003596 / 'ATAGACTACCTCAGCCCAAGATTTCCGTATTGTAAATATGCTGGGAAAGGATGGCAATAAAGCCTACGCACTATATCGTACCTCTCAGGAATTAAAGACA'(0.22993995539435697 / 'ATAGGTTCCTTCAGCCCGAGATTTCCATACTGTAAATATAATGGGTAAGGATAGCAATTAAACTTACGTACGTTATCATACCTCCTCGAAATTAAAGCCA' + 'SpeciesTwenty-Four')(0.22993995539435697 / 'ATAGACTACCTCAGCCTAAGTTTTCCGTATTGCAAATTTGCTGGGAAAGGATGGTAGTAAAGCCTACGCACTATATCGTATCTTTTAGGAATTAAAGACA' + 'SpeciesTwenty-Three')))(1.2037884902723617 / 'GTGGACGACCCAAGCATGGCACTCTTGACCGGTGAAAATGCTAAGGCTTAAGAGCAATGACTTTCCCCTACTATACTACACCGCTAGGAAAATAGTGGTG' + 'SpeciesTwenty-Two'))(0.5549070890817979 / 'ATAGTCGCCTCTATTTTCGCGCCCAGGATCAGCAGGAGAAACAAGAATTGAGGACAAAAAGCTCCAACTCTTTAATCATACCACTAGGGAAATAGTAGTG'(0.09544683701875112 / 'ATATTCGCCTCTATTTTCGCGCCCAGGATCAGCAGGAGAAACAAGGATTGAGCACCAGGAGCTCCAACTTTTTAATCATACCACGTGGGAAATAATAGTG'(1.027507806027312 / 'ATATTCGCCTCTATTTTCGCGCACAGGATCAGCAGGAGAAACAAGGATTGAGCACCAGGAGCTCCAACTTTTCAATCATACCACGTGGGAAATAATAGTG' + 'SpeciesTwenty-One')(1.027507806027312 / 'ATATTCCATTCTATTTTCGCGCCCAGCATCAGCAGAAGAAACAAGAATTAACCGCTAGGAATTTCAATTTTTCATTCATGCCACGTGGCAAATAATGGCG' + 'SpeciesTwenty'))(1.122954643046063 / 'ATAGCCGCCCCTATTTTCGTGCCCAGGATCAGTAGGAGAAACAAGAATTGAGGACAAAAGGCCCCAACTGTTTAATCATACCACTAGGGAAATAGTAGTG' + 'SpeciesNineteen'))))(2.24053274940822 / 'ATAGACGAATTTGCTTTAGCACTCTCCATGAGCAGAATTGGACACAGCTGAAGAAAATTATCTTTTCTTATATGATCCTGCCACGAGGCACGTAATGATA' + 'SpeciesEighteen')))(0.09994604472566589 / 'GTCAGCCAATTTGCCGTGGAATCCCTTGTGGCAAGAATTTAAAACAGCCTAAGAGAATTAGCTCATCTACTATGATCCCGGTACAAAACACACAATGATT'(2.549444838150361 / 'GTCAATCAATTTACAGTAGAGTCCTTTGTGGCATGAAGTTGAAACTGCTTAAGTGATTTAGCTCATCCACTATAATCCCGGTACAACAGCTACGACGGAT' + 'SpeciesSeventeen')(0.1289448313125364 / 'GTCAGCCAATCTGCCACGGAATTCCTTGTGACAAGAATTTGAAACAGTCTAAGAGGATTAGCTTATCTACTATGATCCTGGTACAAAACACACAATGATA'(2.4205000068378246 / 'GTCAGCCAATCTGCCACGGAATTCCTTATAACAAGAACTTGAAACAGTCTAAGAGGATGAGCTTATCTACTATGATCCTGGTACAAAACACACAATGATA' + 'SpeciesSixteen')(0.30687612190260766 / 'GTCAGTTGTTCTGTTACGGAAGTCCTTGTGATAAGATTTTGAAACAGTCTAAGAGGATTAGCTATTCTATTATAGTCTTGGTACAAACCACGCAATGGTA'(0.5192403079153792 / 'GTCAGTTGTTCTGATATGGAAGTCCCAGCGATGAGACAATGAAGCAGCCTAAGGTAATTATTTATTCTGTCGTAATCTTGGTACCGACCGCGGAATCGCA'(0.19585996807133246 / 'GTCAGTTGTTCTGAAATGGAAGTCCCAGCGATGAGATAATTAAGCAGCCTGAAGTAATTAGTTATCCTGTCGTAATCTTGGTACCGACCGCGGAATCGCA'(1.3985236089485054 / 'GTCGGGTGTCCTGGAGTAGAAATCCCATCGATGAGATAATTAGGCATTCTAAAGTAACCGATTAATCTGTCGTAATGTTGACAATTCCCGCGGGATCTCA' + 'SpeciesFifteen')(1.3985236089485054 / 'GTCAGTTGTTCTGAAATGGAAGTCCCAGCGATGAGATAATTAAGCAGCCTGAAGTAATTAGTTATCCTGTCGTAATCTTGGTACCGACCTCGGAATCGCA' + 'SpeciesFourteen'))(1.5943835770198378 / 'GTGAAATATGAAGAAATACCAAGGTCTCCGACGCCACAATAAGTGATGACGAAGTAATGATTAGTTAAGTCGCAATCTAGATGCCAAATTCACTGTAGTA' + 'SpeciesThirteen'))(0.18087200152160426 / 'GTCGGTCGTTCTGTTACGATAGTCCTTGTGATAAGCTTTTTAAACTGTCTAAGAAGATTAGCTATTCTATTATAGTCATGGTACAAACCACGCAGTGGTA'(1.9327518834136128 / 'ATCGGTTGCTCTCTTGGGATGGTCCTTGCGACGTGTTTATTAAATTCCATAGGAAGGCTAACTGTTCTATTATAACTCTGCTGCAACCCACGCAGCGACG' + 'SpeciesTwelve')(1.9327518834136128 / 'ATGAGTCGAATCCTTATGGATAATCTTGTGGCGGGCTACTAGATCCCTGCAGAGGGGGGTACCGTGCTGACTTCATATTGTGAGATCCCATTTGGTATTA' + 'SpeciesEleven'))))))))(0.2910196370637555 / 'GTGCATTCGTTCACTACGGAATCCCCAGTCCTAGGAAATTGGAAGAGTACAAGAAAGTTGTCTTATCTAATACGGTCTCGAAGTTTAACAGATAATGGTA'(3.0778160910645327 / 'ATATAACTGTCCGCCAGCGAATGCCCAGTCCCAGCCAAAGGGAGAAGTAAAGTTAAATTGTCTTATCTAAGGTAGTCCCGTGGTATAACAAAGAATGATG' + 'SpeciesTen')(0.05046954755773034 / 'GTGCATTCGTTCACTACGGAATCCCTAGTACTAGGAAATTAGAAGAGTACAAGAAAGTTGTCTTATCTAATACAGTCTCGAAGTTTAACAGATAATGGTA'(0.22233027055641796 / 'GTGCATTCGTGCACTACGGAATCCCTTGTATTGGGAAATTATAAGCGTACAAGAAAGTTGTCTTATATAATACAGTCTCAAAGTTCAACAAATAATAGCA'(0.3184512956314025 / 'GCGCATTCGTGCACTCCGGAATCCCCTGTTTTGAGGAATCATAAGCGTATAAGTAAGTTGTCTTATATAGTTCAATCTCATAGTACAAACAACAATAGCA'(2.4865649773189817 / 'GTGCATTCGTATGTTCCGCAATCCCCTGTACCGTGGAAAAATAAGTGTATATGTGAATTTCCCTATATAGTTCCATTTCGTCAGACAAACAACACTAGCT' + 'SpeciesNine')(2.4865649773189817 / 'GCGCATTCGCGCTCTCCGAAATCCCATGTTTTGAGAAATCACAAGCGTATAAGTAAGTTTTCTTATACAGTTCAATCTCATAGTACAAATAACAATAGCA' + 'SpeciesEight'))(2.8050162729503842 / 'CTAGAATCGTACACTACGGGCTCACCTGTATTAATGTATTGTAACTGTATAAGAAGATTATCTTATGTATTACGGTCCAAAAGTTCAACAAGTAATAGTA' + 'SpeciesSeven'))(3.0273465435068023 / 'GTCCATTTGTTGAGTATGGACTATCTAGTACTATGAGGTTAGAAGAGTACAAGAAAGTTGTCTTATCCAATACGGTCTCGAAGTTTAACAGATAATGCTG' + 'SpeciesSix'))))))(0.06341286822912655 / 'CAAAATACAACCCAGCTGCAATGCGCAAATCCCACTGATTGGACCATCACGGTTGAAGAGTATCTTCCCCTTTAGTCTCAGCGTCTATCCTATGATTGTG'(4.6630042901371205 / 'CAAAATACAACCCAGCTGCGATGCGCGAATCCCACTGATTGGACCATCACGGTTGAAGAGTATTTTCCCCTTTAGTCTCAGCGTCTATCTTTTGATTATG' + 'SpeciesFive')(4.6630042901371205 / 'CTTAAAACAGCCCAGCTGCAATGCGCAAATCCCACTGATTGGACCATCACGGTTGAGGAGCATCGTCCCCTTTAGTCTCAGCATTTATCATATGAACATG' + 'SpeciesFour')))(5.375749871773895 / 'TGTGATACCGCCGTGTTGCTATACGGTAGTCAGACTGTTTGGATCATGGTGAGTGTACTGTATCTGCCTTTTTGATCTTAACACTCATTAGATGACTGTA' + 'SpeciesThree'))(5.615348729514021 / 'CAAAGTTTCCCATAGTCGCTATATGGTAGTTACACGGTCAGAACTATCGTAAGGGTATAGCATATCCCTTTTCAATTCTTGAGTTCGTTCAATTATAGTA' + 'SpeciesTwo'))(5.677100354573628 / 'TAAAATTTTGCTTAGTTATTATACGGTCGTTACGCTGTTTGTATCATCGTAGGCGTACAGGACACCTCTTTCCAATCCTAAGATGCGTTCGGTTACAGTA' + 'SpeciesOne'))(6.614509490423808 / 'TTACATATCTTTTGATTAAAACAAGCTTGTAGCGCTGTTTCGACCATAGAAGATACTCAACATTTATCTATTCGATTCTATACTCCCTTCGTCTTTAGCA' + 'SpeciesZero'))))"
	t_cur = Tree(1)
	t_cur.str2tree(s,20,by='io')
	trees.append(t_cur)
	for tree in trees:
		print(tree_posterior(tree, alpha, d, D0, B, Q1, Pi, False, None, True))